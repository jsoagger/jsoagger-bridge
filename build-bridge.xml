<?xml version="1.0"?>

<project name="Build offline or Cloud operations and services" basedir="." 
	xmlns:if="ant:if" xmlns:unless="ant:unless" default="build.all">

	<property file="${basedir}/build.properties" />

	<property name="maven.profile" location="javafx11,mysql" />
	<property name="MVN_HOME" value="${env.MVN_HOME}"/>

	<property name="jsoagger-bridge.location" value="${basedir}/jsoagger-bridge/" />
	<property name="jsoagger-cloud-operations.location" value="${jsoagger-bridge.location}/jsoagger-cloud-operations" />
	<property name="jsoagger-offline-operations.location" value="${jsoagger-bridge.location}/jsoagger-offline-operations" />

	<property name="win.maven.clean.install" value="-c 'mvn -o ${maven.bin.fullPath} clean install -Dmaven.test.skip=true'" />
	<property name="linux.maven.clean.install" value="-c '${maven.bin.fullPath} clean install -Dmaven.test.skip=true'" />

	<target name="maven.clean.install">
		<echo>Maven clean install on project ${param1}</echo>
		<exec dir="${param1}" executable="/bin/bash">
			<arg line="-c '${MVN_HOME} clean install -P ${maven.profile} -Dmaven.test.skip=true'" />
		</exec>
	</target>

	<target name="build.offline.operations">
		<echo>Maven clean install on project : ${jsoagger-offline-operations.location}</echo>
		<antcall target="maven.clean.install">
			<param name="param1" value="${jsoagger-cloud-operations.location}" />
		</antcall>
	</target>

	<target name="build.cloud.operations">
		<echo>Maven clean install on project : ${jsoagger-cloud-operations.location}</echo>
		<antcall target="maven.clean.install">
			<param name="param1" value="${jsoagger-cloud-operations.location}" />
		</antcall>
	</target>

	<target name="build.all">
		<echo>Maven clean install on project : ${jsoagger-bridge.location}</echo>
		<antcall target="maven.clean.install">
			<param name="param1" value="${jsoagger-bridge.location}" />
		</antcall>
	</target>
</project>